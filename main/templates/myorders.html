{% extends "base.html" %}
{% block title %}My Orders | Tastynest{% endblock %}
{% block content %}
<h2 style="text-align:center; color:#ff7043; margin-bottom:32px;">My Orders</h2>

<form method="get" style="text-align:center; margin-bottom:24px;">
    <input type="date" name="date" value="{{ filter_date|default:'' }}" style="padding:8px; border-radius:5px; border:1px solid #ccc;">
    <button type="submit" style="background:#43a047; color:#fffbe7; border:none; border-radius:7px; padding:8px 22px; font-weight:600; cursor:pointer;">
        Filter by Date
    </button>
    {% if filter_date %}
        <a href="{% url 'myorders' %}" style="margin-left:12px; color:#ff7043; text-decoration:underline;">Clear Filter</a>
    {% endif %}
</form>

{% if orders %}
    {% for order in orders %}
        <div style="background:#fffbe7; border-radius:12px; margin:24px auto; max-width:500px; padding:24px;">
            <p><strong>Date:</strong> {{ order.created_at }}</p>
            <p><strong>Address:</strong> {{ order.address }}</p>
            <p><strong>Payment:</strong> {{ order.payment_type }}</p>
            <p><strong>Total (after discount):</strong> ₹{{ order.total }}</p>
            <ul>
                {% for item in order.items_list %}
                    <li>
                        {% if item.discount and item.discount > 0 %}
                            <span style="color:#43a047;">Discounted: ₹{{ item.discounted_price }} ({{ item.discount }}% OFF)</span><br>
                            <span style="text-decoration:line-through; color:#888;">₹{{ item.price }}</span>
                        {% else %}
                            ₹{{ item.price }}
                        {% endif %}
                        x {{ item.quantity }} = ₹{{ item.total }}
                    </li>
                {% endfor %}
            </ul>
            <p>
                <strong>Original Total:</strong> ₹{{ order.original_total }}<br>
                <strong>Total (after discount):</strong> ₹{{ order.total }}
            </p>
        </div>
    {% endfor %}
{% else %}
    <p style="text-align:center;">No orders yet.</p>
{% endif %}
{% endblock %}